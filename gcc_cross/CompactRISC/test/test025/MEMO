21 行目をステップ実行したら 23 行目で停止した.

test025.S                                     20               0x14e      17       x
test025.S                                     21               0x154      18       x
test025.S                                     22               0x156      19       x


 14e:	94 00 10 00 	cmpd	$0x100000:l,(r5,r4)
 152:	00 00 
 154:	10 5a       	movw	$0x1:s,r0
 156:	21 5a       	movw	$0x2:s,r1

なのでリンカは正しく動作している. これはデバッガの問題.

cr16-elf-gdb を調査した結果 0x154 で 1 命令実行した後 sim_engine_halt が
期待通り呼び出されている.
そして 16 番(PC のレジスタ番号)のレジスタに対して sim_fetch_register が呼び出され
そこで 0x156 を返している.

ここまでは期待した動作だが 15 番(SP のレジスタ番号)を問い合わせてきた

なるほど, ここまで書いて

	movw	$1, r0
	movw	$2, r1
	cmpw	r0, r1

を以下のように修正してみた.

	movw	$1, r2
	movw	$2, r3
	cmpw	r2, r3

これで期待した通りの動作にはなったがなんだかものすごく怪しい.
