dummy.c の行番号の問題.

dummy.c                                       25               0x1a8      13       x

25 行目が 0x1a8 と対応しているが

000001a6 <__isatty>:
     1a6:	1d 01       	push	$0x2,r13
     1a8:	bf 60 fc ff 	addd	$0xfffc:m,(sp)

0x1a6 の間違い.

dummy.c                                       22               0x19e      12       x

22 行目が 0x19e と対応している.

00000192 <__free_r>:
     192:	1d 01       	push	$0x2,r13
     194:	bf 60 fc ff 	addd	$0xfffc:m,(sp)
     198:	fd 55       	movd	(sp),(r13)
     19a:	2d e0       	stord	(r3,r2),0x0:s(r13)
     19c:	00 2c       	nop
     19e:	df 55       	movd	(r13),(sp)

0x19c の間違い.

dummy.c                                       21               0x194      11       x

21 行目が 0x194 と対応している.

0x192 の間違い.


dummy.c                                       18               0x18a      10       x

18 行目が 0x18a と対応している.


     186:	0d a0       	loadd	0x0:s(r13),(r1,r0)
     188:	df 55       	movd	(r13),(sp)
     18a:	8f 60       	addd	$0x8:s,(sp)
     18c:	1d 02       	pop	$0x2,r13
     18e:	ee 0a       	jump	(ra)

0x188 の間違い.


dummy.c                                       17               0x188       9       x

17 行目が 0x188 と対応している.

0x186 の間違い.

dummy.c                                       16               0x178       8       x

16 行目が 0x178 と対応している.

     176:	12 00 10 f0 	loadw	0x2e8c <_delta.0>:l,r1
     17a:	8c 2e 

0x176 の間違い. << ここを修正したい.


dummy.c                                       15               0x166       6       x

15 行目が 0x166 と対応している.

0000015c <__sbrk_r>:
     15c:	1d 01       	push	$0x2,r13
     15e:	bf 60 f8 ff 	addd	$0xfff8:m,(sp)
     162:	fd 55       	movd	(sp),(r13)
     164:	2d d2       	storw	r2,0x4:s(r13)
     166:	12 00 00 f0 	loadw	0x2e8c <_delta.0>:l,r0
     16a:	8c 2e 
     16c:	00 5e       	movxw	r0,(r1,r0)
     16e:	20 05 00 20 	movd	$0x2000:m,(r3,r2)
     172:	20 61       	addd	(r3,r2),(r1,r0)
     174:	0d e0       	stord	(r1,r0),0x0:s(r13)
     176:	12 00 10 f0 	loadw	0x2e8c <_delta.0>:l,r1
     17a:	8c 2e 

ここはできている.

0x16e の movd 命令がもともと 6 バイトであったが 4 バイトになったが
ここの調整ができていないらしい.


  [0x0000015e]  PC を固定サイズ 10 分進め 0x4c とします

0x15e -


  if (abfd->filename == string("dummy.o")) {
    *(char*)(start+int(0x15e)+1)=8;  
    return;
  }

とすれば期待した結果にはなっている.
